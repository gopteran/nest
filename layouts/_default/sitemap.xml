<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
  xmlns:video="http://www.google.com/schemas/sitemap-video/1.1">

  {{ range .Data.Pages }}
  {{ if and .IsPage (ne .Layout "search") (not (in .Permalink "/tags/")) }}
  <url>
    <loc>{{ .Permalink }}</loc>
    <lastmod>{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</lastmod>
    <changefreq>{{ if eq .Layout "page" }}monthly{{ else }}weekly{{ end }}</changefreq>
    <priority>{{ if .IsHome }}1.0{{ else if eq .Layout "page" }}0.8{{ else }}0.6{{ end }}</priority>

    {{ if site.Params.seo.enableRichSnippets }}
    <!-- Include images if available -->
    {{ with .Resources.ByType "image" }}
    {{ range . }}
    <image:image>
      <image:loc>{{ .Permalink }}</image:loc>
      {{ with $.Params.imageAlt }}<image:caption>{{ . }}</image:caption>{{ end }}
      {{ with $.Params.imageTitle }}<image:title>{{ . }}</image:title>{{ end }}
    </image:image>
    {{ end }}
    {{ end }}

    <!-- Video sitemap entries -->
    {{ if site.Params.advanced.enableVideoSEO }}
    {{ with .Params.video }}
    <video:video>
      <video:thumbnail_loc>{{ .thumbnail | absURL }}</video:thumbnail_loc>
      <video:title>{{ .title | default $.Title }}</video:title>
      <video:description>{{ .description | default $.Summary }}</video:description>
      <video:content_loc>{{ .content_loc | absURL }}</video:content_loc>
      {{ with .duration }}<video:duration>{{ . }}</video:duration>{{ end }}
      {{ with .publication_date }}<video:publication_date>{{ . }}</video:publication_date>{{ end }}
    </video:video>
    {{ end }}
    {{ end }}
    {{ end }}
  </url>
  {{ end }}
  {{ end }}

  <!-- Include taxonomy pages -->
  {{ range $taxonomy, $terms := .Site.Taxonomies }}
  {{ range $term, $weightedPages := $terms }}
  <url>
    <loc>{{ printf "%s/%s/%s/" $.Site.BaseURL $taxonomy $term | absURL }}</loc>
    <lastmod>{{ now.Format "2006-01-02T15:04:05-07:00" | safeHTML }}</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.3</priority>
  </url>
  {{ end }}
  {{ end }}

</urlset>
