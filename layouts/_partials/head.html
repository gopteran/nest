<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Basic SEO Meta Tags -->
<meta name="description" content="{{ if .IsHome }}{{ site.Params.seo.description | default site.Title }}{{ else }}{{ .Summary | default .Title }} | {{ site.Title }}{{ end }}">
<meta name="author" content="{{ site.Params.seo.author | default site.Title }}">
{{ if site.Params.seo.keywords }}<meta name="keywords" content="{{ delimit site.Params.seo.keywords `, ` }}">{{ end }}
{{ if site.Params.seo.robots }}<meta name="robots" content="{{ site.Params.seo.robots }}">{{ end }}
{{ if site.Params.seo.googlebot }}<meta name="googlebot" content="{{ site.Params.seo.googlebot }}">{{ end }}

<!-- Canonical URL -->
<link rel="canonical" href="{{ .Permalink }}">

<!-- Site Verification -->
{{ if site.Params.seo.googleSiteVerification }}<meta name="google-site-verification" content="{{ site.Params.seo.googleSiteVerification }}">{{ end }}
{{ if site.Params.seo.bingSiteVerification }}<meta name="msvalidate.01" content="{{ site.Params.seo.bingSiteVerification }}">{{ end }}
{{ if site.Params.seo.yandexSiteVerification }}<meta name="yandex-verification" content="{{ site.Params.seo.yandexSiteVerification }}">{{ end }}
{{ if site.Params.seo.baiduSiteVerification }}<meta name="baidu-site-verification" content="{{ site.Params.seo.baiduSiteVerification }}">{{ end }}

<!-- Theme and App Meta Tags -->
<!-- Favicon and Icons -->
{{ if site.Params.seo.favicon }}
  {{ $favicon := resources.Get site.Params.seo.favicon }}
  {{ if $favicon }}
    <link rel="icon" type="image/x-icon" href="{{ $favicon.Permalink }}">
  {{ end }}
{{ end }}

<!-- PNG Favicons -->
{{ if site.Params.seo.favicon16 }}
  {{ $favicon16 := resources.Get site.Params.seo.favicon16 }}
  {{ if $favicon16 }}
    <link rel="icon" type="image/png" sizes="16x16" href="{{ $favicon16.Permalink }}">
  {{ end }}
{{ end }}

{{ if site.Params.seo.favicon32 }}
  {{ $favicon32 := resources.Get site.Params.seo.favicon32 }}
  {{ if $favicon32 }}
    <link rel="icon" type="image/png" sizes="32x32" href="{{ $favicon32.Permalink }}">
  {{ end }}
{{ end }}

<!-- Apple Touch Icon -->
{{ if site.Params.seo.appleTouchIcon }}
  {{ $appleTouchIcon := resources.Get site.Params.seo.appleTouchIcon }}
  {{ if $appleTouchIcon }}
    <link rel="apple-touch-icon" sizes="180x180" href="{{ $appleTouchIcon.Permalink }}">
  {{ end }}
{{ end }}

<!-- Android/Chrome Icons -->
{{ if site.Params.seo.androidIcon192 }}
  {{ $android192 := resources.Get site.Params.seo.androidIcon192 }}
  {{ if $android192 }}
    <link rel="icon" type="image/png" sizes="192x192" href="{{ $android192.Permalink }}">
  {{ end }}
{{ end }}

{{ if site.Params.seo.androidIcon512 }}
  {{ $android512 := resources.Get site.Params.seo.androidIcon512 }}
  {{ if $android512 }}
    <link rel="icon" type="image/png" sizes="512x512" href="{{ $android512.Permalink }}">
  {{ end }}
{{ end }}

<!-- Web App Manifest -->
{{ if site.Params.seo.manifest }}<link rel="manifest" href="{{ site.Params.seo.manifest | absURL }}">{{ else }}<link rel="manifest" href="/site.webmanifest">{{ end }}

<!-- Theme Color for Mobile Browsers -->
{{ if site.Params.seo.themeColor }}<meta name="theme-color" content="{{ site.Params.seo.themeColor }}">{{ else }}<meta name="theme-color" content="#2563eb">{{ end }}
{{ if site.Params.seo.tileColor }}<meta name="msapplication-TileColor" content="{{ site.Params.seo.tileColor }}">{{ else }}<meta name="msapplication-TileColor" content="#2563eb">{{ end }}

{{ range site.Params.customMeta.additionalMeta }}
<meta name="{{ .name }}" content="{{ .content }}">
{{ end }}

<!-- Open Graph / Facebook -->
<meta property="og:type" content="{{ if .IsHome }}{{ site.Params.social.openGraphType | default `website` }}{{ else }}article{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:title" content="{{ if .IsHome }}{{ site.Params.seo.title | default site.Title }}{{ else }}{{ .Title }} | {{ site.Title }}{{ end }}">
<meta property="og:description" content="{{ if .IsHome }}{{ site.Params.seo.description | default site.Title }}{{ else }}{{ .Summary | default .Title }}{{ end }}">
{{ if site.Params.seo.defaultImage }}<meta property="og:image" content="{{ site.Params.seo.defaultImage | absURL }}">{{ end }}
{{ if site.Params.seo.defaultImageAlt }}<meta property="og:image:alt" content="{{ site.Params.seo.defaultImageAlt }}">{{ end }}
<meta property="og:site_name" content="{{ site.Title }}">
{{ if site.Params.social.facebookAppId }}<meta property="fb:app_id" content="{{ site.Params.social.facebookAppId }}">{{ end }}

<!-- Twitter -->
<meta property="twitter:card" content="{{ site.Params.social.twitterCard | default `summary_large_image` }}">
<meta property="twitter:url" content="{{ .Permalink }}">
<meta property="twitter:title" content="{{ if .IsHome }}{{ site.Params.seo.title | default site.Title }}{{ else }}{{ .Title }} | {{ site.Title }}{{ end }}">
<meta property="twitter:description" content="{{ if .IsHome }}{{ site.Params.seo.description | default site.Title }}{{ else }}{{ .Summary | default .Title }}{{ end }}">
{{ if site.Params.seo.defaultImage }}<meta property="twitter:image" content="{{ site.Params.seo.defaultImage | absURL }}">{{ end }}
{{ if site.Params.seo.defaultImageAlt }}<meta property="twitter:image:alt" content="{{ site.Params.seo.defaultImageAlt }}">{{ end }}
{{ if site.Params.social.twitterSite }}<meta property="twitter:site" content="{{ site.Params.social.twitterSite }}">{{ end }}
{{ if site.Params.social.twitterCreator }}<meta property="twitter:creator" content="{{ site.Params.social.twitterCreator }}">{{ end }}

<!-- Preload Critical Resources -->
{{ if site.Params.performance.preloadCriticalCSS }}
{{ $cssPath := site.Params.performance.criticalCSSPath | default "/css/main.css" }}
<link rel="preload" href="{{ $cssPath }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="{{ $cssPath }}"></noscript>
{{ end }}
{{ range site.Params.performance.preloadFonts }}
<link rel="preload" href="{{ . | absURL }}" as="font" type="font/woff2" crossorigin>
{{ end }}

<!-- Structured Data (JSON-LD) -->
{{ if site.Params.schema.enableRichSnippets }}
<!-- Organization Schema -->
{{ if site.Params.schema.organization }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{{ site.Params.schema.organization.type }}",
  "name": "{{ site.Params.schema.organization.name }}",
  "url": "{{ site.Params.schema.organization.url }}",
  {{ if site.Params.schema.organization.logo }}"logo": "{{ site.Params.schema.organization.logo | absURL }}",{{ end }}
  {{ if site.Params.schema.organization.description }}"description": "{{ site.Params.schema.organization.description }}",{{ end }}
  {{ if site.Params.schema.organization.foundingDate }}"foundingDate": "{{ site.Params.schema.organization.foundingDate }}",{{ end }}
  {{ if site.Params.schema.organization.contactPoint }}"contactPoint": {{ site.Params.schema.organization.contactPoint | jsonify }},{{ end }}
  {{ if site.Params.schema.organization.sameAs }}"sameAs": {{ site.Params.schema.organization.sameAs | jsonify }}{{ end }}
}
</script>
{{ end }}

<!-- Website Schema -->
{{ if site.Params.schema.website }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{{ site.Params.schema.website.type }}",
  "name": "{{ site.Params.schema.website.name }}",
  "url": "{{ site.Params.schema.website.url }}",
  {{ if site.Params.schema.website.description }}"description": "{{ site.Params.schema.website.description }}",{{ end }}
  {{ if site.Params.schema.website.inLanguage }}"inLanguage": "{{ site.Params.schema.website.inLanguage }}",{{ end }}
  {{ if site.Params.schema.website.potentialAction }}"potentialAction": {{ site.Params.schema.website.potentialAction | jsonify }}{{ end }}
}
</script>
{{ end }}

<!-- Article/BlogPost Schema -->
{{ if and (not .IsHome) site.Params.schema.article.enable }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ .Title }}",
  "description": "{{ .Summary | default .Title }}",
  "image": [
    {{ if site.Params.seo.defaultImage }}"{{ site.Params.seo.defaultImage | absURL }}"{{ end }}
  ],
  "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
  "author": {
    "@type": "{{ site.Params.schema.article.authorType }}",
    {{ if site.Params.seo.author }}"name": "{{ site.Params.seo.author }}"{{ end }}
  },
  "publisher": {
    "@type": "{{ site.Params.schema.article.publisherType }}",
    "name": "{{ site.Title }}",
    {{ if site.Params.seo.logo }}"logo": {
      "@type": "ImageObject",
      "url": "{{ site.Params.seo.logo | absURL }}"
    }{{ end }}
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ .Permalink }}"
  },
  {{ if .Keywords }}"keywords": "{{ delimit .Keywords `, ` }}",{{ end }}
  "articleSection": "{{ .Section }}"
}
</script>
{{ end }}

<!-- Breadcrumb Schema -->
{{ if and site.Params.schema.enableBreadcrumbs (not .IsHome) }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ site.BaseURL }}"
    }{{ range $index, $element := .Ancestors.Reverse }}
    ,{
      "@type": "ListItem",
      "position": {{ add $index 2 }},
      "name": "{{ $element.Title }}",
      "item": "{{ $element.Permalink }}"
    }{{ end }}
    ,{
      "@type": "ListItem",
      "position": {{ add (.Ancestors | len) 2 }},
      "name": "{{ .Title }}",
      "item": "{{ .Permalink }}"
    }
  ]
}
</script>
{{ end }}
{{ end }}

<!-- Analytics and Tracking -->
{{ if site.Params.analytics.googleAnalytics }}
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.Params.analytics.googleAnalytics }}"></script>
{{ if site.Params.analytics.privacy.anonymizeIP }}
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '{{ site.Params.analytics.googleAnalytics }}', {'anonymize_ip': true});
</script>
{{ else }}
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '{{ site.Params.analytics.googleAnalytics }}');
</script>
{{ end }}
{{ end }}

{{ if site.Params.analytics.googleTagManager }}
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','{{ site.Params.analytics.googleTagManager }}');</script>
{{ end }}

{{ if site.Params.analytics.facebookPixel }}
<!-- Facebook Pixel -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '{{ site.Params.analytics.facebookPixel }}');
  fbq('track', 'PageView');
</script>
{{ end }}

<title>{{ if .IsHome }}{{ site.Title }}{{ else }}{{ printf "%s | %s" .Title site.Title }}{{ end }}</title>

<!-- Styles -->
{{ partialCached "head/css.html" . }}


<!-- Custom CSS for enhanced styling -->
<style>
  /* Line clamping utility */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Smooth scroll */
  html {
    scroll-behavior: smooth;
  }

  /* Enhanced focus states */
  *:focus {
    outline: 2px solid var(--color-secondary);
    outline-offset: 2px;
  }

  /* Custom prose styles for content */
  .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
    color: var(--color-primary);
    font-weight: 700;
  }

  .prose a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid var(--color-secondary);
    transition: all 0.2s ease;
  }

  .prose a:hover {
    color: var(--color-secondary);
    border-bottom-color: var(--color-primary);
  }

  .prose blockquote {
    border-left: 4px solid var(--color-sand);
    background: linear-gradient(to right, var(--color-sand)/10, transparent);
    padding: 1rem 1.5rem;
    margin: 1.5rem 0;
    border-radius: var(--radius-base);
  }

  .prose code {
    background: var(--color-neutral-light);
    color: var(--color-primary);
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-base);
    font-size: 0.875em;
  }

  .prose pre {
    background: var(--color-neutral-dark);
    color: var(--color-neutral-light);
    border-radius: var(--radius-lg);
    overflow-x: auto;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-neutral-light);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-secondary);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-primary);
  }
</style>

<!-- Scripts -->
{{ partialCached "head/js.html" . }}
